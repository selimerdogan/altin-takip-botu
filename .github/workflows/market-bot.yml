name: Piyasa Botu (Hafta İci)

on:
  schedule:
    # UTC Saatleri (TR = UTC + 3)
    # 07:20 UTC = 10:20 TR (Açılış)
    - cron: '20 7 * * 1-5'
    # 08:00 - 15:00 UTC = 11:00 - 18:00 TR (Saat Başı)
    - cron: '0 8-15 * * 1-5'
    # 15:15 UTC = 18:15 TR (Kapanış)
    - cron: '15 15 * * 1-5'
  
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Kodları Çek
        uses: actions/checkout@v3
      - name: Python Kur
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      # --- BURASI GÜNCELLENDİ (yfinance EKLENDİ) ---
      - name: Kütüphaneleri Yükle
        run: pip install firebase-admin requests pandas yfinance beautifulsoup4

      - name: Botu Çalıştır
        env:
          FIREBASE_KEY: ${{ secrets.FIREBASE_KEY }}
          CMC_API_KEY: ${{ secrets.CMC_API_KEY }}
        run: python market_bot.py
